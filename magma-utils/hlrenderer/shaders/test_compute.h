#pragma once

#include <stdint.h>

static const uint32_t test_compute_spirv_comp[] = {
	0x07230203,0x00010000,0x0008000b,0x0000001d,0x00000000,0x00020011,0x00000001,0x0006000b,
	0x00000001,0x4c534c47,0x6474732e,0x3035342e,0x00000000,0x0003000e,0x00000000,0x00000001,
	0x0006000f,0x00000005,0x00000004,0x6e69616d,0x00000000,0x0000000b,0x00060010,0x00000004,
	0x00000011,0x00000010,0x00000001,0x00000001,0x00030003,0x00000002,0x000001c2,0x00040005,
	0x00000004,0x6e69616d,0x00000000,0x00030005,0x00000008,0x00786469,0x00080005,0x0000000b,
	0x475f6c67,0x61626f6c,0x766e496c,0x7461636f,0x496e6f69,0x00000044,0x00050005,0x00000011,
	0x61746144,0x66667542,0x00007265,0x00050006,0x00000011,0x00000000,0x61746164,0x00000000,
	0x00030005,0x00000013,0x00000000,0x00040047,0x0000000b,0x0000000b,0x0000001c,0x00040047,
	0x00000010,0x00000006,0x00000004,0x00050048,0x00000011,0x00000000,0x00000023,0x00000000,
	0x00030047,0x00000011,0x00000003,0x00040047,0x00000013,0x00000022,0x00000000,0x00040047,
	0x00000013,0x00000021,0x00000000,0x00040047,0x0000001c,0x0000000b,0x00000019,0x00020013,
	0x00000002,0x00030021,0x00000003,0x00000002,0x00040015,0x00000006,0x00000020,0x00000000,
	0x00040020,0x00000007,0x00000007,0x00000006,0x00040017,0x00000009,0x00000006,0x00000003,
	0x00040020,0x0000000a,0x00000001,0x00000009,0x0004003b,0x0000000a,0x0000000b,0x00000001,
	0x0004002b,0x00000006,0x0000000c,0x00000000,0x00040020,0x0000000d,0x00000001,0x00000006,
	0x0003001d,0x00000010,0x00000006,0x0003001e,0x00000011,0x00000010,0x00040020,0x00000012,
	0x00000002,0x00000011,0x0004003b,0x00000012,0x00000013,0x00000002,0x00040015,0x00000014,
	0x00000020,0x00000001,0x0004002b,0x00000014,0x00000015,0x00000000,0x00040020,0x00000018,
	0x00000002,0x00000006,0x0004002b,0x00000006,0x0000001a,0x00000010,0x0004002b,0x00000006,
	0x0000001b,0x00000001,0x0006002c,0x00000009,0x0000001c,0x0000001a,0x0000001b,0x0000001b,
	0x00050036,0x00000002,0x00000004,0x00000000,0x00000003,0x000200f8,0x00000005,0x0004003b,
	0x00000007,0x00000008,0x00000007,0x00050041,0x0000000d,0x0000000e,0x0000000b,0x0000000c,
	0x0004003d,0x00000006,0x0000000f,0x0000000e,0x0003003e,0x00000008,0x0000000f,0x0004003d,
	0x00000006,0x00000016,0x00000008,0x0004003d,0x00000006,0x00000017,0x00000008,0x00060041,
	0x00000018,0x00000019,0x00000013,0x00000015,0x00000016,0x0003003e,0x00000019,0x00000017,
	0x000100fd,0x00010038
};

/*
#version 450
layout(local_size_x = 16, local_size_y = 1, local_size_z = 1) in;

layout(binding = 0, std430) buffer DataBuffer
{
    uint data[];
} _19;

void main()
{
    uint idx = gl_GlobalInvocationID.x;
    _19.data[idx] = idx;
}

*/
static const uint8_t test_compute_glsl_comp[] = {
	0x23,0x76,0x65,0x72,0x73,0x69,0x6f,0x6e,0x20,0x34,0x35,0x30,0x0a,0x6c,0x61,0x79,
	0x6f,0x75,0x74,0x28,0x6c,0x6f,0x63,0x61,0x6c,0x5f,0x73,0x69,0x7a,0x65,0x5f,0x78,
	0x20,0x3d,0x20,0x31,0x36,0x2c,0x20,0x6c,0x6f,0x63,0x61,0x6c,0x5f,0x73,0x69,0x7a,
	0x65,0x5f,0x79,0x20,0x3d,0x20,0x31,0x2c,0x20,0x6c,0x6f,0x63,0x61,0x6c,0x5f,0x73,
	0x69,0x7a,0x65,0x5f,0x7a,0x20,0x3d,0x20,0x31,0x29,0x20,0x69,0x6e,0x3b,0x0a,0x0a,
	0x6c,0x61,0x79,0x6f,0x75,0x74,0x28,0x62,0x69,0x6e,0x64,0x69,0x6e,0x67,0x20,0x3d,
	0x20,0x30,0x2c,0x20,0x73,0x74,0x64,0x34,0x33,0x30,0x29,0x20,0x62,0x75,0x66,0x66,
	0x65,0x72,0x20,0x44,0x61,0x74,0x61,0x42,0x75,0x66,0x66,0x65,0x72,0x0a,0x7b,0x0a,
	0x20,0x20,0x20,0x20,0x75,0x69,0x6e,0x74,0x20,0x64,0x61,0x74,0x61,0x5b,0x5d,0x3b,
	0x0a,0x7d,0x20,0x5f,0x31,0x39,0x3b,0x0a,0x0a,0x76,0x6f,0x69,0x64,0x20,0x6d,0x61,
	0x69,0x6e,0x28,0x29,0x0a,0x7b,0x0a,0x20,0x20,0x20,0x20,0x75,0x69,0x6e,0x74,0x20,
	0x69,0x64,0x78,0x20,0x3d,0x20,0x67,0x6c,0x5f,0x47,0x6c,0x6f,0x62,0x61,0x6c,0x49,
	0x6e,0x76,0x6f,0x63,0x61,0x74,0x69,0x6f,0x6e,0x49,0x44,0x2e,0x78,0x3b,0x0a,0x20,
	0x20,0x20,0x20,0x5f,0x31,0x39,0x2e,0x64,0x61,0x74,0x61,0x5b,0x69,0x64,0x78,0x5d,
	0x20,0x3d,0x20,0x69,0x64,0x78,0x3b,0x0a,0x7d,0x0a,0x0a
};

/*
static const uint3 gl_WorkGroupSize = uint3(16u, 1u, 1u);

RWByteAddressBuffer _19 : register(u0);

static uint3 gl_GlobalInvocationID;
struct SPIRV_Cross_Input
{
    uint3 gl_GlobalInvocationID : SV_DispatchThreadID;
};

void comp_main()
{
    uint idx = gl_GlobalInvocationID.x;
    _19.Store(idx * 4 + 0, idx);
}

[numthreads(16, 1, 1)]
void main(SPIRV_Cross_Input stage_input)
{
    gl_GlobalInvocationID = stage_input.gl_GlobalInvocationID;
    comp_main();
}
*/
static const uint8_t test_compute_hlsl_comp[] = {
	0x73,0x74,0x61,0x74,0x69,0x63,0x20,0x63,0x6f,0x6e,0x73,0x74,0x20,0x75,0x69,0x6e,
	0x74,0x33,0x20,0x67,0x6c,0x5f,0x57,0x6f,0x72,0x6b,0x47,0x72,0x6f,0x75,0x70,0x53,
	0x69,0x7a,0x65,0x20,0x3d,0x20,0x75,0x69,0x6e,0x74,0x33,0x28,0x31,0x36,0x75,0x2c,
	0x20,0x31,0x75,0x2c,0x20,0x31,0x75,0x29,0x3b,0x0a,0x0a,0x52,0x57,0x42,0x79,0x74,
	0x65,0x41,0x64,0x64,0x72,0x65,0x73,0x73,0x42,0x75,0x66,0x66,0x65,0x72,0x20,0x5f,
	0x31,0x39,0x20,0x3a,0x20,0x72,0x65,0x67,0x69,0x73,0x74,0x65,0x72,0x28,0x75,0x30,
	0x29,0x3b,0x0a,0x0a,0x73,0x74,0x61,0x74,0x69,0x63,0x20,0x75,0x69,0x6e,0x74,0x33,
	0x20,0x67,0x6c,0x5f,0x47,0x6c,0x6f,0x62,0x61,0x6c,0x49,0x6e,0x76,0x6f,0x63,0x61,
	0x74,0x69,0x6f,0x6e,0x49,0x44,0x3b,0x0a,0x73,0x74,0x72,0x75,0x63,0x74,0x20,0x53,
	0x50,0x49,0x52,0x56,0x5f,0x43,0x72,0x6f,0x73,0x73,0x5f,0x49,0x6e,0x70,0x75,0x74,
	0x0a,0x7b,0x0a,0x20,0x20,0x20,0x20,0x75,0x69,0x6e,0x74,0x33,0x20,0x67,0x6c,0x5f,
	0x47,0x6c,0x6f,0x62,0x61,0x6c,0x49,0x6e,0x76,0x6f,0x63,0x61,0x74,0x69,0x6f,0x6e,
	0x49,0x44,0x20,0x3a,0x20,0x53,0x56,0x5f,0x44,0x69,0x73,0x70,0x61,0x74,0x63,0x68,
	0x54,0x68,0x72,0x65,0x61,0x64,0x49,0x44,0x3b,0x0a,0x7d,0x3b,0x0a,0x0a,0x76,0x6f,
	0x69,0x64,0x20,0x63,0x6f,0x6d,0x70,0x5f,0x6d,0x61,0x69,0x6e,0x28,0x29,0x0a,0x7b,
	0x0a,0x20,0x20,0x20,0x20,0x75,0x69,0x6e,0x74,0x20,0x69,0x64,0x78,0x20,0x3d,0x20,
	0x67,0x6c,0x5f,0x47,0x6c,0x6f,0x62,0x61,0x6c,0x49,0x6e,0x76,0x6f,0x63,0x61,0x74,
	0x69,0x6f,0x6e,0x49,0x44,0x2e,0x78,0x3b,0x0a,0x20,0x20,0x20,0x20,0x5f,0x31,0x39,
	0x2e,0x53,0x74,0x6f,0x72,0x65,0x28,0x69,0x64,0x78,0x20,0x2a,0x20,0x34,0x20,0x2b,
	0x20,0x30,0x2c,0x20,0x69,0x64,0x78,0x29,0x3b,0x0a,0x7d,0x0a,0x0a,0x5b,0x6e,0x75,
	0x6d,0x74,0x68,0x72,0x65,0x61,0x64,0x73,0x28,0x31,0x36,0x2c,0x20,0x31,0x2c,0x20,
	0x31,0x29,0x5d,0x0a,0x76,0x6f,0x69,0x64,0x20,0x6d,0x61,0x69,0x6e,0x28,0x53,0x50,
	0x49,0x52,0x56,0x5f,0x43,0x72,0x6f,0x73,0x73,0x5f,0x49,0x6e,0x70,0x75,0x74,0x20,
	0x73,0x74,0x61,0x67,0x65,0x5f,0x69,0x6e,0x70,0x75,0x74,0x29,0x0a,0x7b,0x0a,0x20,
	0x20,0x20,0x20,0x67,0x6c,0x5f,0x47,0x6c,0x6f,0x62,0x61,0x6c,0x49,0x6e,0x76,0x6f,
	0x63,0x61,0x74,0x69,0x6f,0x6e,0x49,0x44,0x20,0x3d,0x20,0x73,0x74,0x61,0x67,0x65,
	0x5f,0x69,0x6e,0x70,0x75,0x74,0x2e,0x67,0x6c,0x5f,0x47,0x6c,0x6f,0x62,0x61,0x6c,
	0x49,0x6e,0x76,0x6f,0x63,0x61,0x74,0x69,0x6f,0x6e,0x49,0x44,0x3b,0x0a,0x20,0x20,
	0x20,0x20,0x63,0x6f,0x6d,0x70,0x5f,0x6d,0x61,0x69,0x6e,0x28,0x29,0x3b,0x0a,0x7d,
	0x0a
};

static inline const mg_shader get_test_compute_shader(mg_renderer_type type) {
    mg_shader shader = {0};
    switch (type) {
        case MG_RENDERER_TYPE_VULKAN:
            shader.compute.code = (void*)test_compute_spirv_comp;
            shader.compute.size = sizeof(test_compute_spirv_comp);
            break;
        case MG_RENDERER_TYPE_DIRECT3D11:
            shader.compute.code = (void*)test_compute_hlsl_comp;
            shader.compute.size = sizeof(test_compute_hlsl_comp);
            break;
        case MG_RENDERER_TYPE_OPENGL:
            shader.compute.code = (void*)test_compute_glsl_comp;
            shader.compute.size = sizeof(test_compute_glsl_comp);
            break;
    }

    return shader;
}

